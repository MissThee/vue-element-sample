(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3d784ab9"],{ae9c:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",[n("el-input",{attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),n("el-tree",{ref:"treeType",style:{overflow:"auto",padding:"0px",top:"0px"},attrs:{data:e.treeData,props:e.defaultProps,"node-key":"id","default-expand-all":"","expand-on-click-node":!1,"render-content":e.edtingMode?e.renderContent:null,"filter-node-method":e.filterNode},on:{"node-click":e.handleNodeClick}}),n("el-dialog",{attrs:{title:e.dialogTitle[e.formDialogStatus],visible:e.formDialogVisible,"close-on-click-modal":!1,"append-to-body":""},on:{"update:visible":function(t){e.formDialogVisible=t}}},[n("el-form",{ref:"formData",attrs:{rules:e.rules,size:"mini",model:e.form,"label-width":"80px"}},[n("el-form-item",{attrs:{label:"所属类别",prop:"loginId"}},[n("el-cascader",{attrs:{props:e.cascaderProps,placeholder:"所属类别","show-all-levels":!1,options:e.typeList,filterable:"",clearable:!1,"change-on-select":""},on:{change:e.setCurrentParentId},model:{value:e.currentNodePath,callback:function(t){e.currentNodePath=t},expression:"currentNodePath"}})],1),n("el-form-item",{attrs:{label:"类别名称",prop:"loginId"}},[n("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.formDialogVisible=!1}}},[e._v("取消")]),n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.postData()}}},[e._v("确定")])],1)],1)],1)},i=[],a=(n("ac6a"),n("b24b")),o=n("b893"),l={name:"tree-list",data:function(){return{clientHeight:0,treeData:[],defaultProps:{children:"children",label:"label"},dialogTitle:{update:"编辑",create:"创建"},formDialogStatus:"",rules:{name:[{required:!0,message:"类别名称不能为空",trigger:"blur"}]},formDialogVisible:!1,form:{id:null,parentId:null,name:null},cascaderProps:{value:"id"},currentNodePath:[],typeList:[],filterText:"",edtingMode:!1}},mounted:function(){this.clientHeight="".concat(document.documentElement.clientHeight)-80;var e=this;window.onresize=function(){e.clientHeight="".concat(document.documentElement.clientHeight)-80}},watch:{filterText:function(e){this.$refs.treeType.filter(e)}},methods:{getNodePath:function(e,t){for(var n=[],r=0;r<t.length;r++){var i=t[r];try{(function(){var t=function t(r){if(n.push(r.id),r.id===parseInt(e))throw"GOT IT!";if(r.children&&r.children.length>0){for(var i=0;i<r.children.length;i++)t(r.children[i]);n.pop()}else n.pop()};t(i)})()}catch(a){}}return n},fetchData:function(e){this.treeData=[{id:0,label:"【所有类别】",children:e}]},renderContent:function(e,t){var n=t.node,r=t.data,i=(t.store,this);return e("span",{attrs:{style:"flex: 1; display: flex; align-items: center; justify-content: space-between; font-size: 14px; padding-right: 8px;"}},[e("span",[e("span",{attrs:{style:"float: left;"}},n.label)]),e("span",[e("el-button",{attrs:{size:"mini",style:"font-size: 12px;padding: 3px",type:"text",plain:""},on:{click:function(){var e=i.deepCopy(i.treeData);i.formDialogVisible=!0,i.formDialogStatus="create",delete i.form.id,i.form.name="",i.form.parentId=r.id;var t=i.getNodePath(i.form.parentId,e);i.typeList=i.setDisabledNode(e,null),i.currentNodePath=t}}},"添加"),e("el-button",{attrs:{size:"mini",style:"font-size: 12px;padding: 3px;"+(0===r.id?"display:none;":""),type:"text",plain:""},on:{click:function(){if(0!==r.id){var e=i.deepCopy(i.treeData);i.formDialogVisible=!0,i.formDialogStatus="update",i.form.id=r.id,i.form.name=r.label,i.form.parentId=r.parentId;var t=i.getNodePath(i.form.id,e),n=t.pop();i.typeList=i.setDisabledNode(e,n),i.currentNodePath=t}}}},"编辑"),e("el-button",{attrs:{size:"mini",style:"font-size: 12px;color:red;padding: 3px;"+(0===r.id?"display:none;":""),type:"text",plain:""},on:{click:function(){0!==r.id&&i.$confirm('将删除类别 <span style="color:blue">'+r.label+"</span>，若此类别下有知识条目，删除此类别后，只能在【所有类别】中查看这些知识条目，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0}).then(function(){i.listLoading=!0,Object(a["d"])(r.id).then(function(e){i.listLoading=!1,i.refreshNode(),Object(o["b"])(e,"删除")})}).catch(function(){})}}},"删除")])])},postData:function(){var e=this;this.$refs["formData"].validate(function(t){t&&("update"===e.formDialogStatus?(e.listLoading=!0,Object(a["i"])(e.form).then(function(t){e.listLoading=!1,e.formDialogVisible=!1,e.refreshNode(),Object(o["b"])(t,"更新")})):"create"===e.formDialogStatus&&(e.listLoading=!0,Object(a["b"])(e.form).then(function(t){e.listLoading=!1,e.formDialogVisible=!1,e.refreshNode(),Object(o["b"])(t,"添加")})))})},setCurrentParentId:function(){this.currentNodePath.length>0&&(this.form.parentId=this.currentNodePath[this.currentNodePath.length-1])},setDisabledNode:function(e,t){var n=function e(t,n){var r=t.filter(function(e){return e.id!==n});return r.forEach(function(t){return t.children&&(t.children=e(t.children,n))}),r},r=n(e,t);return r},deepCopy:function(e){return JSON.parse(JSON.stringify(e))},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},setEdtingMode:function(e){this.edtingMode=e},handleNodeClick:function(e){this.$emit("setCurrentSelectedId",e.id)},refreshNode:function(){this.$emit("refreshNode")}}},d=l,c=n("2877"),s=Object(c["a"])(d,r,i,!1,null,"1b13c886",null);t["default"]=s.exports},b24b:function(e,t,n){"use strict";n.d(t,"f",function(){return i}),n.d(t,"e",function(){return a}),n.d(t,"h",function(){return o}),n.d(t,"a",function(){return l}),n.d(t,"c",function(){return d}),n.d(t,"g",function(){return c}),n.d(t,"i",function(){return s}),n.d(t,"b",function(){return u}),n.d(t,"d",function(){return f});var r=n("b775");function i(e,t,n,i){return Object(r["a"])({url:"/dangerousChemicals/table",data:{pageNumber:e,pageSize:t,typeId:n,keyWords:i}})}function a(e){return Object(r["a"])({url:"/dangerousChemicals/dangerousChemicals",data:{id:e}})}function o(e){return Object(r["a"])({url:"/dangerousChemicals/update",data:{form:e}})}function l(e){return Object(r["a"])({url:"/dangerousChemicals/create",data:{form:e}})}function d(e){return Object(r["a"])({url:"/dangerousChemicals/delete",data:{id:e}})}function c(e){return Object(r["a"])({url:"/dangerousChemicalsType/typeList",data:{needChildren:e}})}function s(e){return Object(r["a"])({url:"/dangerousChemicalsType/update",data:{form:e}})}function u(e){return Object(r["a"])({url:"/dangerousChemicalsType/create",data:{form:e}})}function f(e){return Object(r["a"])({url:"/dangerousChemicalsType/delete",data:{id:e}})}}}]);