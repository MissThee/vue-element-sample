(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2477700d","chunk-3d784ab9","chunk-2d0c42d0"],{"115f":function(e,t,r){"use strict";var n=r("e845"),a=r.n(n);a.a},"39e7":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"animate",staticStyle:{overflow:"hidden",height:"100%"}},[r("el-button",{directives:[{name:"show",rawName:"v-show",value:e.showButton,expression:"showButton"}],style:{float:"right",marginRight:"-5px",fontWeight:"bold",width:"15px",paddingLeft:"5px",position:"absolute",zIndex:"1000",left:e.showLeftBar?e.initLeftWidth-10+"px":"-7px",top:e.clientHeight/2+"px"},attrs:{icon:e.showLeftBar?"el-icon-arrow-left":"el-icon-arrow-right",size:"mini",type:"primary",plain:""},on:{click:function(t){return e.handleSwitchType()}}}),r("el-row",{attrs:{gutter:3,type:"flex",justify:"end"}},[r("el-col",{style:{width:e.leftWidth+"px"}},[r("el-card",{attrs:{"body-style":{height:e.clientHeight-60+"px",overflow:"auto",padding:"0px"}}},[r("div",{attrs:{slot:"header"},slot:"header"},[r("span",[e._v("类别")]),r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑类型",placement:"top-start"}},[r("el-button",{staticStyle:{float:"right",padding:"3px"},attrs:{icon:"el-icon-edit",type:"text",plain:""},on:{click:function(t){return e.handleEditingType()}}},[e._v(e._s(e.editingType?"结束编辑":"编辑类别"))])],1)],1),r("tree-list",{ref:"typeTree",on:{setCurrentSelectedId:e.handleSelectType,refreshNode:e.fetchTypeData}})],1)],1),r("el-col",{style:{width:e.clientWidth-e.leftWidth+"px",borderLeft:"2px solid #89DBFF"}},[r("el-row",{staticClass:"grid-tool-bar"},[r("el-button",{attrs:{icon:e.showSearch?"el-icon-arrow-down":"el-icon-arrow-up",size:"mini",type:"primary",plain:""},on:{click:function(t){return e.handleSwitchSearch()}}},[e._v(e._s(e.showSearch?"取消查找":"查找"))]),r("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.handleCreate()}}},[e._v("添加")])],1),e.showSearch?r("el-row",{staticClass:"grid-tool-bar"},[r("el-input",{staticStyle:{width:"300px",margin:"0px"},attrs:{placeholder:"名称/编号",size:"mini"},model:{value:e.keyWords.nameOrId,callback:function(t){e.$set(e.keyWords,"nameOrId",t)},expression:"keyWords.nameOrId"}}),r("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.loadTable()}}},[e._v("查找")])],1):e._e(),r("el-table",{staticStyle:{width:"100%",height:"100%"},attrs:{"v-loading":e.listLoading,data:e.dangerousChemicalsData,height:e.clientHeight-e.searchBarHeight-32,stripe:"","default-sort":{prop:"loginId",order:"ascending"},border:""}},[r("el-table-column",{attrs:{type:"index",label:"序号",width:"50"}}),r("el-table-column",{attrs:{prop:"typeName",align:"center",label:"类型","min-width":"120",sortable:""}}),r("el-table-column",{attrs:{prop:"id",align:"center",label:"编号","min-width":"80",sortable:""}}),r("el-table-column",{attrs:{prop:"name",align:"center",label:"名称","min-width":"120",sortable:""}}),r("el-table-column",{attrs:{prop:"specialWarning",label:"特别警示","min-width":"400",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[r("pre",[e._v(e._s(t.row.specialWarning))])]}}])}),r("el-table-column",{attrs:{prop:"chemicalFormula",label:"化学式","min-width":"200",sortable:""}}),r("el-table-column",{attrs:{label:"危险性"}},[r("el-table-column",{attrs:{prop:"dangerCombustionExplosion",label:"燃烧爆炸危险性","min-width":"400",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[r("pre",[e._v(e._s(t.row.dangerCombustionExplosion))])]}}])}),r("el-table-column",{attrs:{prop:"dangerBody",label:"人体危害","min-width":"400",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[r("pre",[e._v(e._s(t.row.dangerBody))])]}}])}),r("el-table-column",{attrs:{prop:"dangerEnvironmental",label:"环境影响","min-width":"400",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[r("pre",[e._v(e._s(t.row.dangerEnvironmental))])]}}])})],1),r("el-table-column",{attrs:{label:"理化特性及用途"}},[r("el-table-column",{attrs:{prop:"characteristic",label:"理化特性","min-width":"400",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[r("pre",[e._v(e._s(t.row.characteristic))])]}}])}),r("el-table-column",{attrs:{prop:"purpose",label:"用途","min-width":"400",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[r("pre",[e._v(e._s(t.row.purpose))])]}}])})],1),r("el-table-column",{attrs:{prop:"individualProtection",label:"个体防护","min-width":"400",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[r("pre",[e._v(e._s(t.row.individualProtection))])]}}])}),r("el-table-column",{attrs:{label:"物理属性"}},[r("el-table-column",{attrs:{prop:"emergencyQuarantine",label:"隔离与公共安全","min-width":"400",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[r("pre",[e._v(e._s(t.row.emergencyQuarantine))])]}}])}),r("el-table-column",{attrs:{prop:"emergencyLeakage",label:"泄漏处理","min-width":"400",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[r("pre",[e._v(e._s(t.row.emergencyLeakage))])]}}])}),r("el-table-column",{attrs:{prop:"emergencyFire",label:"火灾扑救","min-width":"400",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[r("pre",[e._v(e._s(t.row.emergencyFire))])]}}])}),r("el-table-column",{attrs:{prop:"emergencyFirstAid",label:"急救","min-width":"400",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[r("pre",[e._v(e._s(t.row.emergencyFirstAid))])]}}])})],1),r("el-table-column",{attrs:{prop:"path",label:"附件","min-width":"200",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{directives:[{name:"show",rawName:"v-show",value:""!==t.row.fileName,expression:"scope.row.fileName!==''"}]},[r("el-tooltip",{attrs:{content:t.row.path,effect:"dark",placement:"top"}},[r("a",{attrs:{href:t.row.path,download:""}},[r("el-tag",{attrs:{size:"mini",color:"white"}},[e._v(e._s(t.row.fileName))])],1)])],1)]}}])}),r("el-table-column",{attrs:{prop:"lastEditUserName",label:"编辑人",width:"100",sortable:""}}),r("el-table-column",{attrs:{fixed:"right",label:"操作",width:"106"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini",type:"text",plain:""},on:{click:function(r){return e.handleUpdate(t.row)}}},[r("i",{staticClass:"el-icon-edit "}),e._v("编辑\n            ")]),r("el-button",{staticStyle:{color:"red"},attrs:{size:"mini",type:"text",plain:""},on:{click:function(r){return e.handelDelete(t.row.id,t.row.name)}}},[r("i",{staticClass:"el-icon-circle-close-outline "}),e._v("删除\n            ")])]}}])})],1),r("el-pagination",{attrs:{"current-page":e.pageNumber,"page-size":e.pageSize,layout:" prev, pager, next, jumper",total:e.totalRow},on:{"current-change":e.handleCurrentChange}})],1)],1),r("el-dialog",{attrs:{title:e.dialogTitle[e.formDialogStatus],visible:e.formDialogVisible,"append-to-body":"","close-on-click-modal":!1},on:{"update:visible":function(t){e.formDialogVisible=t}}},[r("el-form",{ref:"formData",attrs:{rules:e.rules,size:"mini",model:e.form,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"类型"}},[r("tree-selector",{ref:"typeSelector",on:{setCurrentId:e.updateTypeId}})],1),r("el-form-item",{attrs:{label:"名称",prop:"name"}},[r("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),r("el-form-item",{attrs:{label:"特别警示"}},[r("el-input",{attrs:{type:"textarea",autosize:!0},model:{value:e.form.specialWarning,callback:function(t){e.$set(e.form,"specialWarning",t)},expression:"form.specialWarning"}})],1),r("el-form-item",{attrs:{label:"化学式"}},[r("el-input",{attrs:{type:"textarea",autosize:!0},model:{value:e.form.chemicalFormula,callback:function(t){e.$set(e.form,"chemicalFormula",t)},expression:"form.chemicalFormula"}})],1),r("el-form-item",{attrs:{label:"危险性"}},[r("el-form-item",{attrs:{label:"燃烧爆炸危险性"}},[r("el-input",{attrs:{type:"textarea",autosize:!0},model:{value:e.form.dangerCombustionExplosion,callback:function(t){e.$set(e.form,"dangerCombustionExplosion",t)},expression:"form.dangerCombustionExplosion"}})],1),r("el-form-item",{attrs:{label:"人体危害"}},[r("el-input",{attrs:{type:"textarea",autosize:!0},model:{value:e.form.dangerBody,callback:function(t){e.$set(e.form,"dangerBody",t)},expression:"form.dangerBody"}})],1),r("el-form-item",{attrs:{label:"环境影响"}},[r("el-input",{attrs:{type:"textarea",autosize:!0},model:{value:e.form.dangerEnvironmental,callback:function(t){e.$set(e.form,"dangerEnvironmental",t)},expression:"form.dangerEnvironmental"}})],1)],1),r("el-form-item",{attrs:{label:"理化特性及用途"}},[r("el-form-item",{attrs:{label:"理化特性"}},[r("el-input",{attrs:{type:"textarea",autosize:!0},model:{value:e.form.characteristic,callback:function(t){e.$set(e.form,"characteristic",t)},expression:"form.characteristic"}})],1),r("el-form-item",{attrs:{label:"用途"}},[r("el-input",{attrs:{type:"textarea",autosize:!0},model:{value:e.form.purpose,callback:function(t){e.$set(e.form,"purpose",t)},expression:"form.purpose"}})],1)],1),r("el-form-item",{attrs:{label:"个体防护"}},[r("el-input",{attrs:{type:"textarea",autosize:!0},model:{value:e.form.individualProtection,callback:function(t){e.$set(e.form,"individualProtection",t)},expression:"form.individualProtection"}})],1),r("el-form-item",{attrs:{label:"理化特性及用途"}},[r("el-form-item",{attrs:{label:"隔离与公共安全"}},[r("el-input",{attrs:{type:"textarea",autosize:!0},model:{value:e.form.emergencyQuarantine,callback:function(t){e.$set(e.form,"emergencyQuarantine",t)},expression:"form.emergencyQuarantine"}})],1),r("el-form-item",{attrs:{label:"泄漏处理"}},[r("el-input",{attrs:{type:"textarea",autosize:!0},model:{value:e.form.emergencyLeakage,callback:function(t){e.$set(e.form,"emergencyLeakage",t)},expression:"form.emergencyLeakage"}})],1),r("el-form-item",{attrs:{label:"火灾扑救"}},[r("el-input",{attrs:{type:"textarea",autosize:!0},model:{value:e.form.emergencyFire,callback:function(t){e.$set(e.form,"emergencyFire",t)},expression:"form.emergencyFire"}})],1),r("el-form-item",{attrs:{label:"急救"}},[r("el-input",{attrs:{type:"textarea",autosize:!0},model:{value:e.form.emergencyFirstAid,callback:function(t){e.$set(e.form,"emergencyFirstAid",t)},expression:"form.emergencyFirstAid"}})],1)],1),r("el-form-item",{attrs:{label:"附件"}},[r("file-uploader",{ref:"fileUploader",on:{getFileInfo:e.getFileInfo,removeFile:e.removeFile}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.formDialogVisible=!1}}},[e._v("取消")]),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.postData()}}},[e._v("确定")])],1)],1)],1)},a=[],i=(r("8e6e"),r("ac6a"),r("456d"),r("bd86")),o=r("b24b"),l=r("b893"),s=r("ae9c"),c=r("e945"),u=r("3a5a"),d=r("2f62"),f=r("5c96");function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(r,!0).forEach(function(t){Object(i["a"])(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var h={name:"dangerousChemicals",components:{FileUploader:u["default"],TreeSelector:c["a"],TreeList:s["default"]},data:function(){return{listLoading:!1,dangerousChemicalsData:[],clientHeight:0,clientWidth:0,showButton:!0,showLeftBar:!0,initLeftWidth:250,leftWidth:250,formDialogVisible:!1,formDialogStatus:"",dialogTitle:{update:"编辑",create:"创建"},form:{typeId:0},user:{},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"}]},showSearch:!1,searchBarHeight:30,editingType:!1,downloadStatusOptions:[{value:1,label:"可下载"},{value:2,label:"已作废"}],keyWords:{nameOrId:"",basicAttributes:"",shape:"",color:"",smell:""},TypeId:0,pageNumber:1,pageSize:50,totalRow:0}},computed:m({},Object(d["b"])({currentUserId:"id"})),mounted:function(){this.fetchTypeData(),this.loadTable(),this.clientHeight="".concat(document.documentElement.clientHeight)-90,this.clientWidth="".concat(document.documentElement.clientWidth)-180;var e=this;window.onresize=function(){e.clientHeight="".concat(document.documentElement.clientHeight)-90,e.clientWidth="".concat(document.documentElement.clientWidth)-180}},methods:{handleSelectType:function(e){this.TypeId=e,this.loadTable()},loadTable:function(){var e=this;this.listLoading=!0,Object(o["f"])(this.pageNumber,this.pageSize,this.TypeId,this.keyWords).then(function(t){e.dangerousChemicalsData=t.data.dangerousChemicalsTable,e.totalRow=t.data.totalRow,e.listLoading=!1})},handleCreate:function(){var e=this;this.form={type:this.TypeId,path:"",fileName:""},this.formDialogStatus="create",this.formDialogVisible=!0,this.initTypeSelector(this.typeData,this.TypeId),this.$nextTick(function(){e.$refs.fileUploader.clearFiles()})},handelDelete:function(e,t){var r=this;this.$confirm('将删除条目 <span style="color:blue">'+t+"</span>，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0}).then(function(){r.listLoading=!0,Object(o["c"])(e).then(function(e){r.listLoading=!1,r.loadTable(),Object(l["b"])(e,"删除")})}).catch(function(){})},handleUpdate:function(e){var t=this;this.listLoading=!0,Object(o["e"])(e.id).then(function(e){t.form=e.data.dangerousChemicals,""!==t.form.fileName&&t.$nextTick(function(){t.$refs.fileUploader.setFiles(t.form.fileName,t.form.filePath)})}),this.listLoading=!1,this.formDialogStatus="update",this.formDialogVisible=!0,this.initTypeSelector(this.typeData,e.type)},postData:function(){var e=this;this.$refs["formData"].validate(function(t){if(t){if(e.$refs.fileUploader.getUploadingState())return void Object(f["Notification"])({message:"文件尚未完成上传",type:"error",duration:1500});"update"===e.formDialogStatus?(e.listLoading=!0,Object(o["h"])(e.form).then(function(t){e.listLoading=!1,e.formDialogVisible=!1,e.loadTable(),Object(l["b"])(t,"更新")})):"create"===e.formDialogStatus&&(e.listLoading=!0,Object(o["a"])(e.form).then(function(t){e.listLoading=!1,e.formDialogVisible=!1,e.loadTable(),Object(l["b"])(t,"添加")}))}})},getStatusName:function(e){switch(e){case 1:return{name:"可下载",type:"primary",canDownLoad:!0};case 2:return{name:"已作废",type:"danger",canDownLoad:!1};case 3:return{name:"审核中",type:"warning",canDownLoad:!1};default:return{name:"未设置",type:"warning",canDownLoad:!1}}},handleSwitchType:function(){this.showLeftBar?(this.showLeftBar=!1,this.leftWidth=0):(this.showLeftBar=!0,this.leftWidth=this.initLeftWidth)},handleSwitchSearch:function(){this.showSearch?(this.showSearch=!1,this.searchBarHeight=30,this.keyWords={nameOrId:"",basicAttributes:"",shape:"",color:"",smell:""},this.loadTable()):(this.showSearch=!0,this.searchBarHeight=65)},handleEditingType:function(){this.editingType?(this.editingType=!1,this.leftWidth=this.initLeftWidth,this.showButton=!0):(this.editingType=!0,this.leftWidth=this.clientWidth,this.showButton=!1),this.$refs.typeTree.setEdtingMode(this.editingType)},fetchTypeData:function(){var e=this;Object(o["g"])(!0).then(function(t){e.typeData=t.data.typeList,e.$refs.typeTree.fetchData(t.data.typeList)})},updateTypeId:function(e){this.form.type=e},initTypeSelector:function(e,t){var r=this;this.$nextTick(function(){r.$refs.typeSelector.initData(e),r.$refs.typeSelector.initCurrentPath(t)})},getFileInfo:function(e,t){this.form.fileName=e,this.form.path=t,console.log(this.form)},removeFile:function(){this.form.fileName="",this.form.path=""},handleCurrentChange:function(e){this.pageNumber=e,this.loadTable()}}},g=h,b=(r("115f"),r("2877")),y=Object(b["a"])(g,n,a,!1,null,"18d19440",null);t["default"]=y.exports},"3a5a":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-upload",{ref:"uploader",attrs:{action:e.process.env.BASE_API+"dangerousChemicals/uploadFile",drag:"","file-list":e.fileList,limit:1,"on-exceed":e.handleExceed,multiple:!1,"auto-upload":!0,"on-change":e.getFileList,"on-remove":e.removeFile,"before-upload":e.checkFileSize,headers:e.headers,"on-success":e.uploadSuccess,"on-progress":e.onProgress,"on-error":e.onError}},[r("i",{staticClass:"el-icon-upload"}),r("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),r("em",[e._v("点击上传")])]),r("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" 文件不超过50M")])])},a=[],i=(r("8e6e"),r("ac6a"),r("456d"),r("bd86")),o=r("2f62");function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(r,!0).forEach(function(t){Object(i["a"])(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var c={name:"file-uploader",components:{},data:function(){return{fileList:[],fileUploading:!1}},mounted:function(){},computed:s({},Object(o["b"])(["token"]),{headers:function(){return{Authorization:this.token}}}),methods:{handleExceed:function(e,t){this.$message.warning("当前限制上传 1 个文件，选择了 ".concat(e.length+t.length,"个文件"))},getFileList:function(e,t){},removeFile:function(e,t){this.$emit("removeFile")},checkFileSize:function(e){var t=e.size/1024/1024<50;return t||this.$message.error("上传附件大小不能超过 50MB!"),t},uploadSuccess:function(e,t,r){this.fileUploading=!1,console.log(e,t,r),e.data.result?this.$emit("getFileInfo",e.data.fileName,e.data.filePath):(this.$message.error("上传附件出错，上传失败"),this.$refs.uploader.clearFiles())},clearFiles:function(){this.$refs.uploader.clearFiles()},setFiles:function(e,t){this.fileList=[{name:e,url:t}]},onProgress:function(){this.fileUploading=!0},onError:function(){this.fileUploading=!1},getUploadingState:function(){return this.fileUploading}}},u=c,d=r("2877"),f=Object(d["a"])(u,n,a,!1,null,"acf2466a",null);t["default"]=f.exports},ae9c:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("span",[r("el-input",{attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),r("el-tree",{ref:"treeType",style:{overflow:"auto",padding:"0px",top:"0px"},attrs:{data:e.treeData,props:e.defaultProps,"node-key":"id","default-expand-all":"","expand-on-click-node":!1,"render-content":e.edtingMode?e.renderContent:null,"filter-node-method":e.filterNode},on:{"node-click":e.handleNodeClick}}),r("el-dialog",{attrs:{title:e.dialogTitle[e.formDialogStatus],visible:e.formDialogVisible,"close-on-click-modal":!1,"append-to-body":""},on:{"update:visible":function(t){e.formDialogVisible=t}}},[r("el-form",{ref:"formData",attrs:{rules:e.rules,size:"mini",model:e.form,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"所属类别",prop:"loginId"}},[r("el-cascader",{attrs:{props:e.cascaderProps,placeholder:"所属类别","show-all-levels":!1,options:e.typeList,filterable:"",clearable:!1,"change-on-select":""},on:{change:e.setCurrentParentId},model:{value:e.currentNodePath,callback:function(t){e.currentNodePath=t},expression:"currentNodePath"}})],1),r("el-form-item",{attrs:{label:"类别名称",prop:"loginId"}},[r("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.formDialogVisible=!1}}},[e._v("取消")]),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.postData()}}},[e._v("确定")])],1)],1)],1)},a=[],i=(r("ac6a"),r("b24b")),o=r("b893"),l={name:"tree-list",data:function(){return{clientHeight:0,treeData:[],defaultProps:{children:"children",label:"label"},dialogTitle:{update:"编辑",create:"创建"},formDialogStatus:"",rules:{name:[{required:!0,message:"类别名称不能为空",trigger:"blur"}]},formDialogVisible:!1,form:{id:null,parentId:null,name:null},cascaderProps:{value:"id"},currentNodePath:[],typeList:[],filterText:"",edtingMode:!1}},mounted:function(){this.clientHeight="".concat(document.documentElement.clientHeight)-80;var e=this;window.onresize=function(){e.clientHeight="".concat(document.documentElement.clientHeight)-80}},watch:{filterText:function(e){this.$refs.treeType.filter(e)}},methods:{getNodePath:function(e,t){for(var r=[],n=0;n<t.length;n++){var a=t[n];try{(function(){var t=function t(n){if(r.push(n.id),n.id===parseInt(e))throw"GOT IT!";if(n.children&&n.children.length>0){for(var a=0;a<n.children.length;a++)t(n.children[a]);r.pop()}else r.pop()};t(a)})()}catch(i){}}return r},fetchData:function(e){this.treeData=[{id:0,label:"【所有类别】",children:e}]},renderContent:function(e,t){var r=t.node,n=t.data,a=(t.store,this);return e("span",{attrs:{style:"flex: 1; display: flex; align-items: center; justify-content: space-between; font-size: 14px; padding-right: 8px;"}},[e("span",[e("span",{attrs:{style:"float: left;"}},r.label)]),e("span",[e("el-button",{attrs:{size:"mini",style:"font-size: 12px;padding: 3px",type:"text",plain:""},on:{click:function(){var e=a.deepCopy(a.treeData);a.formDialogVisible=!0,a.formDialogStatus="create",delete a.form.id,a.form.name="",a.form.parentId=n.id;var t=a.getNodePath(a.form.parentId,e);a.typeList=a.setDisabledNode(e,null),a.currentNodePath=t}}},"添加"),e("el-button",{attrs:{size:"mini",style:"font-size: 12px;padding: 3px;"+(0===n.id?"display:none;":""),type:"text",plain:""},on:{click:function(){if(0!==n.id){var e=a.deepCopy(a.treeData);a.formDialogVisible=!0,a.formDialogStatus="update",a.form.id=n.id,a.form.name=n.label,a.form.parentId=n.parentId;var t=a.getNodePath(a.form.id,e),r=t.pop();a.typeList=a.setDisabledNode(e,r),a.currentNodePath=t}}}},"编辑"),e("el-button",{attrs:{size:"mini",style:"font-size: 12px;color:red;padding: 3px;"+(0===n.id?"display:none;":""),type:"text",plain:""},on:{click:function(){0!==n.id&&a.$confirm('将删除类别 <span style="color:blue">'+n.label+"</span>，若此类别下有知识条目，删除此类别后，只能在【所有类别】中查看这些知识条目，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0}).then(function(){a.listLoading=!0,Object(i["d"])(n.id).then(function(e){a.listLoading=!1,a.refreshNode(),Object(o["b"])(e,"删除")})}).catch(function(){})}}},"删除")])])},postData:function(){var e=this;this.$refs["formData"].validate(function(t){t&&("update"===e.formDialogStatus?(e.listLoading=!0,Object(i["i"])(e.form).then(function(t){e.listLoading=!1,e.formDialogVisible=!1,e.refreshNode(),Object(o["b"])(t,"更新")})):"create"===e.formDialogStatus&&(e.listLoading=!0,Object(i["b"])(e.form).then(function(t){e.listLoading=!1,e.formDialogVisible=!1,e.refreshNode(),Object(o["b"])(t,"添加")})))})},setCurrentParentId:function(){this.currentNodePath.length>0&&(this.form.parentId=this.currentNodePath[this.currentNodePath.length-1])},setDisabledNode:function(e,t){var r=function e(t,r){var n=t.filter(function(e){return e.id!==r});return n.forEach(function(t){return t.children&&(t.children=e(t.children,r))}),n},n=r(e,t);return n},deepCopy:function(e){return JSON.parse(JSON.stringify(e))},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},setEdtingMode:function(e){this.edtingMode=e},handleNodeClick:function(e){this.$emit("setCurrentSelectedId",e.id)},refreshNode:function(){this.$emit("refreshNode")}}},s=l,c=r("2877"),u=Object(c["a"])(s,n,a,!1,null,"1b13c886",null);t["default"]=u.exports},b24b:function(e,t,r){"use strict";r.d(t,"f",function(){return a}),r.d(t,"e",function(){return i}),r.d(t,"h",function(){return o}),r.d(t,"a",function(){return l}),r.d(t,"c",function(){return s}),r.d(t,"g",function(){return c}),r.d(t,"i",function(){return u}),r.d(t,"b",function(){return d}),r.d(t,"d",function(){return f});var n=r("b775");function a(e,t,r,a){return Object(n["a"])({url:"/dangerousChemicals/table",data:{pageNumber:e,pageSize:t,typeId:r,keyWords:a}})}function i(e){return Object(n["a"])({url:"/dangerousChemicals/dangerousChemicals",data:{id:e}})}function o(e){return Object(n["a"])({url:"/dangerousChemicals/update",data:{form:e}})}function l(e){return Object(n["a"])({url:"/dangerousChemicals/create",data:{form:e}})}function s(e){return Object(n["a"])({url:"/dangerousChemicals/delete",data:{id:e}})}function c(e){return Object(n["a"])({url:"/dangerousChemicalsType/typeList",data:{needChildren:e}})}function u(e){return Object(n["a"])({url:"/dangerousChemicalsType/update",data:{form:e}})}function d(e){return Object(n["a"])({url:"/dangerousChemicalsType/create",data:{form:e}})}function f(e){return Object(n["a"])({url:"/dangerousChemicalsType/delete",data:{id:e}})}},e845:function(e,t,r){},e945:function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"masker"}},[r("el-cascader",{attrs:{size:"mini",props:e.cascaderProps,placeholder:"未选择","show-all-levels":!1,options:e.treeData,filterable:"",clearable:!1,"change-on-select":"","expand-trigger":"click"},on:{change:e.setCurrentId},model:{value:e.currentNodePath,callback:function(t){e.currentNodePath=t},expression:"currentNodePath"}})],1)},a=[],i={name:"treeSelector",data:function(){return{treeData:[],cascaderProps:{value:"id"},currentNodePath:[]}},methods:{initData:function(e){this.treeData=e},initCurrentPath:function(e){this.currentNodePath=this.getNodePath(e,this.treeData)},getNodePath:function(e,t){var r=[];try{var n=function t(n){if(r.push(n.id),n.id===parseInt(e))throw"GOT IT!";if(n.children&&n.children.length>0){for(var a=0;a<n.children.length;a++)t(n.children[a]);r.pop()}else r.pop()};n({id:0,children:t})}catch(a){}return r},setCurrentId:function(e){e.length>0?(this.currentNodePath=this.getNodePath(e[e.length-1],this.treeData),this.$emit("setCurrentId",e[e.length-1])):this.$emit("setCurrentId",null)}}},o=i,l=r("2877"),s=Object(l["a"])(o,n,a,!1,null,"ebceff4e",null);t["a"]=s.exports}}]);