{"version":3,"sources":["webpack:///./src/views/systemManage/company/index.vue?9f32","webpack:///src/views/systemManage/company/index.vue","webpack:///./src/views/systemManage/company/index.vue?ba98","webpack:///./src/views/systemManage/company/index.vue","webpack:///./src/api/company.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","staticStyle","attrs","model","value","callback","$$v","filterText","expression","ref","style","height","clientHeight","overflow","padding","treeData","renderContent","filterNode","dialogTitle","formDialogStatus","formDialogVisible","on","$event","rules","form","cascaderProps","$set","slot","_v","postData","staticRenderFns","component","fetchCompanyList","currentUserCompany","limitType","request","url","data","updateCompany","createCompany","deleteCompany","id","fetchCompanyOne"],"mappings":"yHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,UAAUC,YAAY,CAAC,SAAW,SAAS,OAAS,SAAS,CAACH,EAAG,WAAW,CAACI,MAAM,CAAC,YAAc,aAAaC,MAAM,CAACC,MAAOV,EAAc,WAAEW,SAAS,SAAUC,GAAMZ,EAAIa,WAAWD,GAAKE,WAAW,gBAAgBV,EAAG,UAAU,CAACW,IAAI,cAAcC,MAAM,CAAEC,OAAOjB,EAAIkB,aAAa,GAAI,KAAKC,SAAS,OAAOC,QAAQ,OAAQZ,MAAM,CAAC,KAAOR,EAAIqB,SAAS,WAAW,KAAK,qBAAqB,GAAG,wBAAuB,EAAM,iBAAiBrB,EAAIsB,cAAc,qBAAqBtB,EAAIuB,cAAcnB,EAAG,YAAY,CAACI,MAAM,CAAC,MAAQR,EAAIwB,YAAYxB,EAAIyB,kBAAkB,QAAUzB,EAAI0B,kBAAkB,wBAAuB,EAAM,iBAAiB,IAAIC,GAAG,CAAC,iBAAiB,SAASC,GAAQ5B,EAAI0B,kBAAkBE,KAAU,CAACxB,EAAG,UAAU,CAACW,IAAI,WAAWP,MAAM,CAAC,MAAQR,EAAI6B,MAAM,KAAO,OAAO,MAAQ7B,EAAI8B,KAAK,cAAc,SAAS,CAAC1B,EAAG,eAAe,CAACI,MAAM,CAAC,MAAQ,OAAO,KAAO,aAAa,CAACJ,EAAG,cAAc,CAACI,MAAM,CAAC,MAAQR,EAAI+B,cAAc,YAAc,OAAO,mBAAkB,EAAM,QAAU/B,EAAIqB,SAAS,WAAa,GAAG,WAAY,GAAOZ,MAAM,CAACC,MAAOV,EAAI8B,KAAa,SAAEnB,SAAS,SAAUC,GAAMZ,EAAIgC,KAAKhC,EAAI8B,KAAM,WAAYlB,IAAME,WAAW,oBAAoB,GAAGV,EAAG,eAAe,CAACI,MAAM,CAAC,MAAQ,OAAO,KAAO,SAAS,CAACJ,EAAG,WAAW,CAACK,MAAM,CAACC,MAAOV,EAAI8B,KAAS,KAAEnB,SAAS,SAAUC,GAAMZ,EAAIgC,KAAKhC,EAAI8B,KAAM,OAAQlB,IAAME,WAAW,gBAAgB,IAAI,GAAGV,EAAG,OAAO,CAACE,YAAY,gBAAgBE,MAAM,CAAC,KAAO,UAAUyB,KAAK,UAAU,CAAC7B,EAAG,YAAY,CAACuB,GAAG,CAAC,MAAQ,SAASC,GAAQ5B,EAAI0B,mBAAoB,KAAS,CAAC1B,EAAIkC,GAAG,QAAQ9B,EAAG,YAAY,CAACI,MAAM,CAAC,KAAO,WAAWmB,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAO5B,EAAImC,cAAc,CAACnC,EAAIkC,GAAG,SAAS,IAAI,IAAI,IACruDE,EAAkB,G,wBCgCtB,GACE,KAAF,gBACE,KAFF,WAGI,MAAJ,CACM,aAAN,EACM,SAAN,GACM,YAAN,CACQ,OAAR,KACQ,OAAR,MAEM,iBAAN,GACM,MAAN,CACQ,KAAR,EAAU,UAAV,EAAU,QAAV,UAAU,QAAV,UAEM,mBAAN,EACM,KAAN,CACQ,GAAR,KACQ,SAAR,KACQ,KAAR,MAEM,cAAN,CACQ,MAAR,KACQ,cAAR,QACQ,eAAR,GAEM,gBAAN,GACM,WAAN,KAGE,QA7BF,WA8BI,KAAJ,YAEI,KAAJ,iEACI,IAAJ,OACI,OAAJ,oBACM,EAAN,mEAIE,MAAF,CACI,WADJ,SACA,GACM,KAAN,8BAGE,QAAF,CAGI,UAHJ,WAGM,IAAN,OACM,OAAN,OAAM,GAAN,iBACQ,EAAR,WACU,IAAV,EACU,MAAV,SACU,SAAV,wBAII,cAAJ,cAAM,IAAN,SAAU,EAAV,OACA,GADA,QACA,MACM,OAAN,UACQ,MAAR,CACU,MAAV,sHAEA,CACA,UACA,UACQ,MAAR,CACU,MAAV,iBAEA,WAEA,UACA,eACQ,MAAR,CACU,KAAV,OACU,MAAV,+BACU,KAAV,OACU,MAAV,IACQ,GAAR,CACU,MADV,WAEY,EAAZ,qBACY,EAAZ,iCACA,UACY,EAAZ,aACY,EAAZ,sBAGA,MACA,eACQ,MAAR,CACU,KAAV,OACU,MAAV,6DACU,KAAV,OACU,MAAV,IAEQ,GAAR,CACU,MAAV,WACA,SACc,EAAd,0BACc,EAAd,qBACc,EAAd,8BAIA,MACA,eACQ,MAAR,CACU,KAAV,OACU,MAAV,uEACU,KAAV,OACU,MAAV,IACQ,GAAR,CACU,MAAV,WACA,QACc,EAAd,yEACgB,kBAAhB,KACgB,iBAAhB,KACgB,KAAhB,UACgB,0BAAhB,IACA,gBACgB,EAAhB,eACgB,OAAhB,OAAgB,CAAhB,uBACkB,EAAlB,eACkB,EAAlB,YACkB,OAAlB,OAAkB,CAAlB,YAEA,uBAKA,WAII,SA1FJ,WA0FM,IAAN,OACM,KAAN,uCACA,IACA,+BACY,EAAZ,eACY,OAAZ,OAAY,CAAZ,yBACc,EAAd,eACc,EAAd,qBACc,EAAd,YACc,OAAd,OAAc,CAAd,UACA,SACA,gCACY,EAAZ,eACY,OAAZ,OAAY,CAAZ,yBACc,EAAd,eACc,EAAd,qBACc,EAAd,YACc,OAAd,OAAc,CAAd,eAMI,WAjHJ,SAiHA,KACM,OAAN,IACA,wBAEI,oBArHJ,SAqHA,GAAM,IAAN,OACM,OAAN,OAAM,CAAN,oBACQ,EAAR,kBACQ,EAAR,4BACA,oBACU,EAAV,iBAEU,EAAV,mCCzM6W,I,YCOzWC,EAAY,eACd,EACAtC,EACAqC,GACA,EACA,KACA,WACA,MAIa,aAAAC,E,2CClBf,gLAEO,SAASC,EAAkBC,EAAmBC,GACnD,OAAOC,eAAQ,CACbC,IAAK,gBACLC,KAAK,CAAC,mBAAqBJ,EAAmB,UAAYC,KAIvD,SAASI,EAAcd,GAC5B,OAAOW,eAAQ,CACbC,IAAK,kBACLC,KAAM,CAAC,KAAQb,KAIZ,SAASe,EAAcf,GAC5B,OAAOW,eAAQ,CACbC,IAAK,kBACLC,KAAM,CAAC,KAAQb,KAIZ,SAASgB,EAAcC,GAC5B,OAAON,eAAQ,CACbC,IAAK,kBACLC,KAAM,CAAC,GAAMI,KAGV,SAASC,EAAgBD,GAC9B,OAAON,eAAQ,CACbC,IAAK,eACLC,KAAM,CAACI","file":"static/js/chunk-5c1efe46.529a8ad7.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"animate\",staticStyle:{\"overflow\":\"hidden\",\"height\":\"100%\"}},[_c('el-input',{attrs:{\"placeholder\":\"输入关键字进行过滤\"},model:{value:(_vm.filterText),callback:function ($$v) {_vm.filterText=$$v},expression:\"filterText\"}}),_c('el-tree',{ref:\"treeCompany\",style:({height:_vm.clientHeight-40 +'px',overflow:'auto',padding:'0px'}),attrs:{\"data\":_vm.treeData,\"node-key\":\"id\",\"default-expand-all\":\"\",\"expand-on-click-node\":false,\"render-content\":_vm.renderContent,\"filter-node-method\":_vm.filterNode}}),_c('el-dialog',{attrs:{\"title\":_vm.dialogTitle[_vm.formDialogStatus],\"visible\":_vm.formDialogVisible,\"close-on-click-modal\":false,\"append-to-body\":\"\"},on:{\"update:visible\":function($event){_vm.formDialogVisible=$event}}},[_c('el-form',{ref:\"formData\",attrs:{\"rules\":_vm.rules,\"size\":\"mini\",\"model\":_vm.form,\"label-width\":\"80px\"}},[_c('el-form-item',{attrs:{\"label\":\"上级部门\",\"prop\":\"parentId\"}},[_c('el-cascader',{attrs:{\"props\":_vm.cascaderProps,\"placeholder\":\"上级部门\",\"show-all-levels\":false,\"options\":_vm.treeData,\"filterable\":\"\",\"clearable\":false},model:{value:(_vm.form.parentId),callback:function ($$v) {_vm.$set(_vm.form, \"parentId\", $$v)},expression:\"form.parentId\"}})],1),_c('el-form-item',{attrs:{\"label\":\"部门名称\",\"prop\":\"name\"}},[_c('el-input',{model:{value:(_vm.form.name),callback:function ($$v) {_vm.$set(_vm.form, \"name\", $$v)},expression:\"form.name\"}})],1)],1),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.formDialogVisible = false}}},[_vm._v(\"取消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.postData()}}},[_vm._v(\"确定\")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"animate\" style=\"overflow: hidden;height: 100%;\">\r\n        <el-input placeholder=\"输入关键字进行过滤\" v-model=\"filterText\"></el-input>\r\n        <el-tree :data=\"treeData\" :style=\"{height:clientHeight-40 +'px',overflow:'auto',padding:'0px'}\" node-key=\"id\" default-expand-all :expand-on-click-node=\"false\" :render-content=\"renderContent\" :filter-node-method=\"filterNode\" ref=\"treeCompany\"></el-tree>\r\n        <el-dialog :title=\"dialogTitle[formDialogStatus]\" :visible.sync=\"formDialogVisible\" :close-on-click-modal=\"false\" append-to-body>\r\n            <el-form :rules=\"rules\" ref=\"formData\" size=\"mini\" :model=\"form\" label-width=\"80px\">\r\n                <el-form-item label=\"上级部门\" prop=\"parentId\">\r\n                    <el-cascader\r\n                            :props=\"cascaderProps\"\r\n                            placeholder=\"上级部门\"\r\n                            :show-all-levels=\"false\"\r\n                            :options=\"treeData\"\r\n                            filterable\r\n                            :clearable=\"false\"\r\n                            v-model=\"form.parentId\"\r\n                    ></el-cascader>\r\n                </el-form-item>\r\n                <el-form-item label=\"部门名称\" prop=\"name\">\r\n                    <el-input v-model=\"form.name\"></el-input>\r\n                </el-form-item>\r\n            </el-form>\r\n            <span slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button @click=\"formDialogVisible = false\">取消</el-button>\r\n          <el-button type=\"primary\" @click=\"postData()\">确定</el-button>\r\n      </span>\r\n        </el-dialog>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import {createCompany, deleteCompany, fetchCompanyList, updateCompany, fetchCompanyOne} from 'src/api/company'\r\n    import {showNotify} from 'src/utils/tools'\r\n\r\n    export default {\r\n        name: \"companyOption\",\r\n        data() {\r\n            return {\r\n                clientHeight: 0,\r\n                treeData: [],\r\n                dialogTitle: {\r\n                    update: '编辑',\r\n                    create: '创建'\r\n                },\r\n                formDialogStatus: '',\r\n                rules: {\r\n                    name: [{required: true, message: '部门名不能为空', trigger: 'blur'}]\r\n                },\r\n                formDialogVisible: false,\r\n                form: {\r\n                    id: null,\r\n                    parentId: null,\r\n                    name: null\r\n                },\r\n                cascaderProps: {\r\n                    value: 'id',\r\n                    expandTrigger: 'hover',\r\n                    checkStrictly: true\r\n                },\r\n                currentNodePath: [],\r\n                filterText: '',\r\n            }\r\n        },\r\n        mounted() {\r\n            this.fetchData()\r\n            // this.$nextTick(function () {\r\n            this.clientHeight = `${document.documentElement.clientHeight}` - 90;\r\n            const that = this;\r\n            window.onresize = function temp() {\r\n                that.clientHeight = `${document.documentElement.clientHeight}` - 90;\r\n            };\r\n            // })\r\n        },\r\n        watch: {\r\n            filterText(val) {\r\n                this.$refs.treeCompany.filter(val);\r\n            }\r\n        },\r\n        methods: {\r\n\r\n\r\n            fetchData() {\r\n                fetchCompanyList().then(response => {\r\n                    this.treeData = [{\r\n                        id: -1,\r\n                        label: '【所有部门】',\r\n                        children: response.data.companyList\r\n                    }];\r\n                })\r\n            },\r\n            renderContent: function (createElement, {node, data, store}) {\r\n                let self = this;\r\n                return createElement('span', {\r\n                    attrs: {\r\n                        style: \"flex: 1; display: flex; align-items: center; justify-content: space-between; font-size: 14px; padding-right: 8px;\"\r\n                    }\r\n                }, [\r\n                    createElement('span', [\r\n                        createElement('span', {\r\n                            attrs: {\r\n                                style: \"float: left;\"\r\n                            }\r\n                        }, node.label)\r\n                    ]),\r\n                    createElement('span', [\r\n                        createElement('el-button', {\r\n                            attrs: {\r\n                                size: \"mini\",\r\n                                style: \"font-size: 12px;padding: 3px\",\r\n                                type: \"text\",\r\n                                plain: ''\r\n                            }, on: {\r\n                                click() {\r\n                                    self.formDialogVisible = true;\r\n                                    self.formDialogStatus = \"create\";\r\n                                    delete self.form.id;\r\n                                    self.form.name = \"\";\r\n                                    self.form.parentId = data.id;\r\n                                }\r\n                            }\r\n                        }, \"添加\"),\r\n                        createElement('el-button', {\r\n                            attrs: {\r\n                                size: \"mini\",\r\n                                style: \"font-size: 12px;padding: 3px;\" + (data.id <= 0 ? \"display:none;\" : \"\"),\r\n                                type: \"text\",\r\n                                plain: ''\r\n                            },\r\n                            on: {\r\n                                click: function () {\r\n                                    if (data.id > 0) {\r\n                                        self.fetchCompanyDataOne(data.id);\r\n                                        self.formDialogVisible = true;\r\n                                        self.formDialogStatus = \"update\";\r\n                                    }\r\n                                }\r\n                            }\r\n                        }, \"编辑\"),\r\n                        createElement('el-button', {\r\n                            attrs: {\r\n                                size: \"mini\",\r\n                                style: \"font-size: 12px;color:red;padding: 3px;\" + (data.id <= 0 ? \"display:none;\" : \"\"),\r\n                                type: \"text\",\r\n                                plain: ''\r\n                            }, on: {\r\n                                click: function () {\r\n                                    if (data.id > 0) {\r\n                                        self.$confirm('将删除部门 <span style=\"color:blue\">' + data.label + '</span>，是否继续?', '提示', {\r\n                                            confirmButtonText: '确定',\r\n                                            cancelButtonText: '取消',\r\n                                            type: 'warning',\r\n                                            dangerouslyUseHTMLString: true\r\n                                        }).then(() => {\r\n                                            self.listLoading = true;\r\n                                            deleteCompany(data.id).then(response => {\r\n                                                self.listLoading = false;\r\n                                                self.fetchData();\r\n                                                showNotify(response, '删除');\r\n                                            })\r\n                                        }).catch(() => {\r\n                                        });\r\n                                    }\r\n                                }\r\n                            }\r\n                        }, \"删除\")\r\n                    ]),\r\n                ]);\r\n            },\r\n            postData() {\r\n                this.$refs['formData'].validate((valid) => {\r\n                    if (valid) {\r\n                        if (this.formDialogStatus === 'update') {\r\n                            this.listLoading = true;\r\n                            updateCompany(this.form).then(response => {\r\n                                this.listLoading = false;\r\n                                this.formDialogVisible = false;\r\n                                this.fetchData();\r\n                                showNotify(response, '更新');\r\n                            }).error()\r\n                        } else if (this.formDialogStatus === 'create') {\r\n                            this.listLoading = true;\r\n                            createCompany(this.form).then(response => {\r\n                                this.listLoading = false;\r\n                                this.formDialogVisible = false;\r\n                                this.fetchData();\r\n                                showNotify(response, '添加');\r\n                            })\r\n                        }\r\n                    }\r\n                })\r\n            },\r\n            filterNode(value, data) {\r\n                if (!value) return true;\r\n                return data.label.indexOf(value) !== -1;\r\n            },\r\n            fetchCompanyDataOne(id) {\r\n                fetchCompanyOne(id).then(response => {\r\n                    this.form.id = response.data.id;\r\n                    this.form.name = response.data.label;\r\n                    if (response.data.parentId === undefined) {\r\n                        this.form.parentId = -1;//级联选择器id值不能为0，否则绑定不上数据，原因不明，仅在此模块中出现此问题\r\n                    } else {\r\n                        this.form.parentId = response.data.parentId;\r\n                    }\r\n                })\r\n            },\r\n\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=f818aa2e&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"f818aa2e\",\n  null\n  \n)\n\nexport default component.exports","import request from '../utils/request'\r\n\r\nexport function fetchCompanyList( currentUserCompany,limitType ) {\r\n  return request({\r\n    url: '/company/list',\r\n    data:{'currentUserCompany':currentUserCompany,'limitType':limitType}\r\n  })\r\n}\r\n\r\nexport function updateCompany(form) {\r\n  return request({\r\n    url: '/company/update',\r\n    data: {'form': form}\r\n  })\r\n}\r\n\r\nexport function createCompany(form) {\r\n  return request({\r\n    url: '/company/create',\r\n    data: {'form': form}\r\n  })\r\n}\r\n\r\nexport function deleteCompany(id) {\r\n  return request({\r\n    url: '/company/delete',\r\n    data: {'id': id}\r\n  })\r\n}\r\nexport function fetchCompanyOne(id) {\r\n  return request({\r\n    url: '/company/one',\r\n    data: {id}\r\n  })\r\n}\r\n"],"sourceRoot":""}