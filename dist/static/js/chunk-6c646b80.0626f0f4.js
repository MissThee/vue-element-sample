(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6c646b80","chunk-3d784ab9","chunk-2d0c42d0"],{"39e7":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"animate",staticStyle:{overflow:"hidden",height:"100%"}},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.showButton,expression:"showButton"}],style:{float:"right",marginRight:"-5px",fontWeight:"bold",width:"15px",paddingLeft:"5px",position:"absolute",zIndex:"1000",left:e.showLeftBar?e.initLeftWidth-10+"px":"-7px",top:e.clientHeight/2+"px"},attrs:{icon:e.showLeftBar?"el-icon-arrow-left":"el-icon-arrow-right",size:"mini",type:"primary",plain:""},on:{click:function(t){return e.handleSwitchType()}}}),a("div",[a("div",{directives:[{name:"show",rawName:"v-show",value:0!==e.leftWidth,expression:"leftWidth!==0"}],style:{position:"absolute",left:0,width:e.leftWidth+"px"}},[a("el-card",{attrs:{"body-style":{height:e.clientHeight-60+"px",overflow:"auto",padding:"0px"}}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[e._v("类别")]),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑类型",placement:"top-start"}},[a("el-button",{staticStyle:{float:"right",padding:"3px"},attrs:{icon:"el-icon-edit",type:"text",plain:""},on:{click:function(t){return e.handleEditingType()}}},[e._v(e._s(e.editingType?"结束编辑":"编辑类别"))])],1)],1),a("tree-list",{ref:"typeTree",on:{setCurrentSelectedId:e.handleSelectType,refreshNode:e.fetchTypeData}})],1)],1),a("div",{style:{position:"absolute",left:e.leftWidth+"px",right:0,borderLeft:"1px solid skyblue"}},[a("el-row",{staticClass:"grid-tool-bar"},[a("el-button",{attrs:{icon:e.showSearch?"el-icon-arrow-down":"el-icon-arrow-up",size:"mini",type:"primary",plain:""},on:{click:function(t){return e.handleSwitchSearch()}}},[e._v(e._s(e.showSearch?"取消查找":"查找"))]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.handleCreate()}}},[e._v("添加")])],1),e.showSearch?a("el-row",{staticClass:"grid-tool-bar"},[a("el-input",{staticStyle:{width:"300px",margin:"0px"},attrs:{placeholder:"名称/编号",size:"mini"},model:{value:e.keyWords.nameOrId,callback:function(t){e.$set(e.keyWords,"nameOrId",t)},expression:"keyWords.nameOrId"}}),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.loadTable()}}},[e._v("查找")])],1):e._e(),a("el-table",{staticStyle:{width:"100%",height:"100%"},attrs:{"v-loading":e.listLoading,data:e.dangerousChemicalsData,height:e.clientHeight-e.searchBarHeight-32,stripe:"","default-sort":{prop:"loginId",order:"ascending"},border:""}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"50"}}),a("el-table-column",{attrs:{prop:"typeName",align:"center",label:"类型","min-width":"120",sortable:""}}),a("el-table-column",{attrs:{prop:"id",align:"center",label:"编号","min-width":"80",sortable:""}}),a("el-table-column",{attrs:{prop:"name",align:"center",label:"名称","min-width":"120",sortable:""}}),a("el-table-column",{attrs:{prop:"specialWarning",label:"特别警示","min-width":"400",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("pre",[e._v(e._s(t.row.specialWarning))])]}}])}),a("el-table-column",{attrs:{prop:"chemicalFormula",label:"化学式","min-width":"200",sortable:""}}),a("el-table-column",{attrs:{label:"危险性"}},[a("el-table-column",{attrs:{prop:"dangerCombustionExplosion",label:"燃烧爆炸危险性","min-width":"400",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("pre",[e._v(e._s(t.row.dangerCombustionExplosion))])]}}])}),a("el-table-column",{attrs:{prop:"dangerBody",label:"人体危害","min-width":"400",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("pre",[e._v(e._s(t.row.dangerBody))])]}}])}),a("el-table-column",{attrs:{prop:"dangerEnvironmental",label:"环境影响","min-width":"400",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("pre",[e._v(e._s(t.row.dangerEnvironmental))])]}}])})],1),a("el-table-column",{attrs:{label:"理化特性及用途"}},[a("el-table-column",{attrs:{prop:"characteristic",label:"理化特性","min-width":"400",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("pre",[e._v(e._s(t.row.characteristic))])]}}])}),a("el-table-column",{attrs:{prop:"purpose",label:"用途","min-width":"400",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("pre",[e._v(e._s(t.row.purpose))])]}}])})],1),a("el-table-column",{attrs:{prop:"individualProtection",label:"个体防护","min-width":"400",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("pre",[e._v(e._s(t.row.individualProtection))])]}}])}),a("el-table-column",{attrs:{label:"物理属性"}},[a("el-table-column",{attrs:{prop:"emergencyQuarantine",label:"隔离与公共安全","min-width":"400",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("pre",[e._v(e._s(t.row.emergencyQuarantine))])]}}])}),a("el-table-column",{attrs:{prop:"emergencyLeakage",label:"泄漏处理","min-width":"400",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("pre",[e._v(e._s(t.row.emergencyLeakage))])]}}])}),a("el-table-column",{attrs:{prop:"emergencyFire",label:"火灾扑救","min-width":"400",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("pre",[e._v(e._s(t.row.emergencyFire))])]}}])}),a("el-table-column",{attrs:{prop:"emergencyFirstAid",label:"急救","min-width":"400",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("pre",[e._v(e._s(t.row.emergencyFirstAid))])]}}])})],1),a("el-table-column",{attrs:{prop:"path",label:"附件","min-width":"200",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{directives:[{name:"show",rawName:"v-show",value:""!==t.row.fileName,expression:"scope.row.fileName!==''"}]},[a("el-tooltip",{attrs:{content:t.row.path,effect:"dark",placement:"top"}},[a("a",{attrs:{href:t.row.path,download:""}},[a("el-tag",{attrs:{size:"mini",color:"white"}},[e._v(e._s(t.row.fileName))])],1)])],1)]}}])}),a("el-table-column",{attrs:{prop:"lastEditUserName",label:"编辑人",width:"100",sortable:""}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"106"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"text",plain:""},on:{click:function(a){return e.handleUpdate(t.row)}}},[a("i",{staticClass:"el-icon-edit "}),e._v("编辑\n                        ")]),a("el-button",{staticStyle:{color:"red"},attrs:{size:"mini",type:"text",plain:""},on:{click:function(a){return e.handelDelete(t.row.id,t.row.name)}}},[a("i",{staticClass:"el-icon-remove "}),e._v("删除\n                        ")])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.pageNumber,"page-size":e.pageSize,layout:" prev, pager, next, jumper",total:e.totalRow},on:{"current-change":e.handleCurrentChange}})],1)]),a("el-dialog",{attrs:{title:e.dialogTitle[e.formDialogStatus],visible:e.formDialogVisible,"append-to-body":"","close-on-click-modal":!1},on:{"update:visible":function(t){e.formDialogVisible=t}}},[a("el-form",{ref:"formData",attrs:{rules:e.rules,size:"mini",model:e.form,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"类型"}},[a("tree-selector",{ref:"typeSelector",on:{setCurrentId:e.updateTypeId}})],1),a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"特别警示"}},[a("el-input",{attrs:{type:"textarea",autosize:!0},model:{value:e.form.specialWarning,callback:function(t){e.$set(e.form,"specialWarning",t)},expression:"form.specialWarning"}})],1),a("el-form-item",{attrs:{label:"化学式"}},[a("el-input",{attrs:{type:"textarea",autosize:!0},model:{value:e.form.chemicalFormula,callback:function(t){e.$set(e.form,"chemicalFormula",t)},expression:"form.chemicalFormula"}})],1),a("el-form-item",{attrs:{label:"危险性"}},[a("el-form-item",{attrs:{label:"燃烧爆炸危险性"}},[a("el-input",{attrs:{type:"textarea",autosize:!0},model:{value:e.form.dangerCombustionExplosion,callback:function(t){e.$set(e.form,"dangerCombustionExplosion",t)},expression:"form.dangerCombustionExplosion"}})],1),a("el-form-item",{attrs:{label:"人体危害"}},[a("el-input",{attrs:{type:"textarea",autosize:!0},model:{value:e.form.dangerBody,callback:function(t){e.$set(e.form,"dangerBody",t)},expression:"form.dangerBody"}})],1),a("el-form-item",{attrs:{label:"环境影响"}},[a("el-input",{attrs:{type:"textarea",autosize:!0},model:{value:e.form.dangerEnvironmental,callback:function(t){e.$set(e.form,"dangerEnvironmental",t)},expression:"form.dangerEnvironmental"}})],1)],1),a("el-form-item",{attrs:{label:"理化特性及用途"}},[a("el-form-item",{attrs:{label:"理化特性"}},[a("el-input",{attrs:{type:"textarea",autosize:!0},model:{value:e.form.characteristic,callback:function(t){e.$set(e.form,"characteristic",t)},expression:"form.characteristic"}})],1),a("el-form-item",{attrs:{label:"用途"}},[a("el-input",{attrs:{type:"textarea",autosize:!0},model:{value:e.form.purpose,callback:function(t){e.$set(e.form,"purpose",t)},expression:"form.purpose"}})],1)],1),a("el-form-item",{attrs:{label:"个体防护"}},[a("el-input",{attrs:{type:"textarea",autosize:!0},model:{value:e.form.individualProtection,callback:function(t){e.$set(e.form,"individualProtection",t)},expression:"form.individualProtection"}})],1),a("el-form-item",{attrs:{label:"理化特性及用途"}},[a("el-form-item",{attrs:{label:"隔离与公共安全"}},[a("el-input",{attrs:{type:"textarea",autosize:!0},model:{value:e.form.emergencyQuarantine,callback:function(t){e.$set(e.form,"emergencyQuarantine",t)},expression:"form.emergencyQuarantine"}})],1),a("el-form-item",{attrs:{label:"泄漏处理"}},[a("el-input",{attrs:{type:"textarea",autosize:!0},model:{value:e.form.emergencyLeakage,callback:function(t){e.$set(e.form,"emergencyLeakage",t)},expression:"form.emergencyLeakage"}})],1),a("el-form-item",{attrs:{label:"火灾扑救"}},[a("el-input",{attrs:{type:"textarea",autosize:!0},model:{value:e.form.emergencyFire,callback:function(t){e.$set(e.form,"emergencyFire",t)},expression:"form.emergencyFire"}})],1),a("el-form-item",{attrs:{label:"急救"}},[a("el-input",{attrs:{type:"textarea",autosize:!0},model:{value:e.form.emergencyFirstAid,callback:function(t){e.$set(e.form,"emergencyFirstAid",t)},expression:"form.emergencyFirstAid"}})],1)],1),a("el-form-item",{attrs:{label:"附件"}},[a("file-uploader",{ref:"fileUploader",on:{getFileInfo:e.getFileInfo,removeFile:e.removeFile}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.formDialogVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.postData()}}},[e._v("确定")])],1)],1)],1)},n=[],i=(a("8e6e"),a("ac6a"),a("456d"),a("bd86")),o=a("b24b"),l=a("b893"),s=a("ae9c"),c=a("e945"),d=a("3a5a"),u=a("2f62"),f=a("5c96");function p(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}function m(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?p(a,!0).forEach(function(t){Object(i["a"])(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):p(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var h={name:"dangerousChemicals",components:{FileUploader:d["default"],TreeSelector:c["a"],TreeList:s["default"]},data:function(){return{listLoading:!1,dangerousChemicalsData:[],clientHeight:0,clientWidth:0,showButton:!0,showLeftBar:!0,initLeftWidth:250,leftWidth:250,formDialogVisible:!1,formDialogStatus:"",dialogTitle:{update:"编辑",create:"创建"},form:{typeId:0},user:{},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"}]},showSearch:!1,searchBarHeight:30,editingType:!1,downloadStatusOptions:[{value:1,label:"可下载"},{value:2,label:"已作废"}],keyWords:{nameOrId:"",basicAttributes:"",shape:"",color:"",smell:""},TypeId:0,pageNumber:1,pageSize:50,totalRow:0}},computed:m({},Object(u["b"])({currentUserId:"id"})),mounted:function(){this.fetchTypeData(),this.loadTable(),this.clientHeight="".concat(document.documentElement.clientHeight)-90,this.clientWidth="".concat(document.documentElement.clientWidth)-180;var e=this;window.onresize=function(){e.clientHeight="".concat(document.documentElement.clientHeight)-90,e.clientWidth="".concat(document.documentElement.clientWidth)-180}},methods:{handleSelectType:function(e){this.TypeId=e,this.loadTable()},loadTable:function(){var e=this;this.listLoading=!0,Object(o["f"])(this.pageNumber,this.pageSize,this.TypeId,this.keyWords).then(function(t){e.dangerousChemicalsData=t.data.dangerousChemicalsTable,e.totalRow=t.data.totalRow,e.listLoading=!1})},handleCreate:function(){var e=this;this.form={type:this.TypeId,path:"",fileName:""},this.formDialogStatus="create",this.formDialogVisible=!0,this.initTypeSelector(this.typeData,this.TypeId),this.$nextTick(function(){e.$refs.fileUploader.clearFiles()})},handelDelete:function(e,t){var a=this;this.$confirm('将删除条目 <span style="color:blue">'+t+"</span>，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0}).then(function(){a.listLoading=!0,Object(o["c"])(e).then(function(e){a.listLoading=!1,a.loadTable(),Object(l["b"])(e,"删除")})}).catch(function(){})},handleUpdate:function(e){var t=this;this.listLoading=!0,Object(o["e"])(e.id).then(function(e){t.form=e.data.dangerousChemicals,""!==t.form.fileName&&t.$nextTick(function(){t.$refs.fileUploader.setFiles(t.form.fileName,t.form.filePath)})}),this.listLoading=!1,this.formDialogStatus="update",this.formDialogVisible=!0,this.initTypeSelector(this.typeData,e.type)},postData:function(){var e=this;this.$refs["formData"].validate(function(t){if(t){if(e.$refs.fileUploader.getUploadingState())return void Object(f["Notification"])({message:"文件尚未完成上传",type:"error",duration:1500});"update"===e.formDialogStatus?(e.listLoading=!0,Object(o["h"])(e.form).then(function(t){e.listLoading=!1,e.formDialogVisible=!1,e.loadTable(),Object(l["b"])(t,"更新")})):"create"===e.formDialogStatus&&(e.listLoading=!0,Object(o["a"])(e.form).then(function(t){e.listLoading=!1,e.formDialogVisible=!1,e.loadTable(),Object(l["b"])(t,"添加")}))}})},getStatusName:function(e){switch(e){case 1:return{name:"可下载",type:"primary",canDownLoad:!0};case 2:return{name:"已作废",type:"danger",canDownLoad:!1};case 3:return{name:"审核中",type:"warning",canDownLoad:!1};default:return{name:"未设置",type:"warning",canDownLoad:!1}}},handleSwitchType:function(){this.showLeftBar?(this.showLeftBar=!1,this.leftWidth=0):(this.showLeftBar=!0,this.leftWidth=this.initLeftWidth)},handleSwitchSearch:function(){this.showSearch?(this.showSearch=!1,this.searchBarHeight=30,this.keyWords={nameOrId:"",basicAttributes:"",shape:"",color:"",smell:""},this.loadTable()):(this.showSearch=!0,this.searchBarHeight=65)},handleEditingType:function(){this.editingType?(this.editingType=!1,this.leftWidth=this.initLeftWidth,this.showButton=!0):(this.editingType=!0,this.leftWidth=this.clientWidth,this.showButton=!1),this.$refs.typeTree.setEdtingMode(this.editingType)},fetchTypeData:function(){var e=this;Object(o["g"])(!0).then(function(t){e.typeData=t.data.typeList,e.$refs.typeTree.fetchData(t.data.typeList)})},updateTypeId:function(e){this.form.type=e},initTypeSelector:function(e,t){var a=this;this.$nextTick(function(){a.$refs.typeSelector.initData(e),a.$refs.typeSelector.initCurrentPath(t)})},getFileInfo:function(e,t){this.form.fileName=e,this.form.path=t,console.log(this.form)},removeFile:function(){this.form.fileName="",this.form.path=""},handleCurrentChange:function(e){this.pageNumber=e,this.loadTable()}}},b=h,g=(a("ab20"),a("2877")),y=Object(g["a"])(b,r,n,!1,null,"edd2d854",null);t["default"]=y.exports},"3a5a":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-upload",{ref:"uploader",attrs:{action:e.process.env.BASE_API+"dangerousChemicals/uploadFile",drag:"","file-list":e.fileList,limit:1,"on-exceed":e.handleExceed,multiple:!1,"auto-upload":!0,"on-change":e.getFileList,"on-remove":e.removeFile,"before-upload":e.checkFileSize,headers:e.headers,"on-success":e.uploadSuccess,"on-progress":e.onProgress,"on-error":e.onError}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" 文件不超过50M")])])},n=[],i=(a("8e6e"),a("ac6a"),a("456d"),a("bd86")),o=a("2f62");function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(a,!0).forEach(function(t){Object(i["a"])(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var c={name:"file-uploader",components:{},data:function(){return{fileList:[],fileUploading:!1}},mounted:function(){},computed:s({},Object(o["b"])(["token"]),{headers:function(){return{Authorization:this.token}}}),methods:{handleExceed:function(e,t){this.$message.warning("当前限制上传 1 个文件，选择了 ".concat(e.length+t.length,"个文件"))},getFileList:function(e,t){},removeFile:function(e,t){this.$emit("removeFile")},checkFileSize:function(e){var t=e.size/1024/1024<50;return t||this.$message.error("上传附件大小不能超过 50MB!"),t},uploadSuccess:function(e,t,a){this.fileUploading=!1,console.log(e,t,a),e.data.result?this.$emit("getFileInfo",e.data.fileName,e.data.filePath):(this.$message.error("上传附件出错，上传失败"),this.$refs.uploader.clearFiles())},clearFiles:function(){this.$refs.uploader.clearFiles()},setFiles:function(e,t){this.fileList=[{name:e,url:t}]},onProgress:function(){this.fileUploading=!0},onError:function(){this.fileUploading=!1},getUploadingState:function(){return this.fileUploading}}},d=c,u=a("2877"),f=Object(u["a"])(d,r,n,!1,null,"acf2466a",null);t["default"]=f.exports},ab20:function(e,t,a){"use strict";var r=a("f7f4"),n=a.n(r);n.a},ae9c:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",[a("el-input",{attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),a("el-tree",{ref:"treeType",style:{overflow:"auto",padding:"0px",top:"0px"},attrs:{data:e.treeData,props:e.defaultProps,"node-key":"id","default-expand-all":"","expand-on-click-node":!1,"render-content":e.edtingMode?e.renderContent:null,"filter-node-method":e.filterNode},on:{"node-click":e.handleNodeClick}}),a("el-dialog",{attrs:{title:e.dialogTitle[e.formDialogStatus],visible:e.formDialogVisible,"close-on-click-modal":!1,"append-to-body":""},on:{"update:visible":function(t){e.formDialogVisible=t}}},[a("el-form",{ref:"formData",attrs:{rules:e.rules,size:"mini",model:e.form,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"所属类别",prop:"loginId"}},[a("el-cascader",{attrs:{props:e.cascaderProps,placeholder:"所属类别","show-all-levels":!1,options:e.typeList,filterable:"",clearable:!1,"change-on-select":""},on:{change:e.setCurrentParentId},model:{value:e.currentNodePath,callback:function(t){e.currentNodePath=t},expression:"currentNodePath"}})],1),a("el-form-item",{attrs:{label:"类别名称",prop:"loginId"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.formDialogVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.postData()}}},[e._v("确定")])],1)],1)],1)},n=[],i=(a("ac6a"),a("b24b")),o=a("b893"),l={name:"tree-list",data:function(){return{clientHeight:0,treeData:[],defaultProps:{children:"children",label:"label"},dialogTitle:{update:"编辑",create:"创建"},formDialogStatus:"",rules:{name:[{required:!0,message:"类别名称不能为空",trigger:"blur"}]},formDialogVisible:!1,form:{id:null,parentId:null,name:null},cascaderProps:{value:"id"},currentNodePath:[],typeList:[],filterText:"",edtingMode:!1}},mounted:function(){this.clientHeight="".concat(document.documentElement.clientHeight)-80;var e=this;window.onresize=function(){e.clientHeight="".concat(document.documentElement.clientHeight)-80}},watch:{filterText:function(e){this.$refs.treeType.filter(e)}},methods:{getNodePath:function(e,t){for(var a=[],r=0;r<t.length;r++){var n=t[r];try{(function(){var t=function t(r){if(a.push(r.id),r.id===parseInt(e))throw"GOT IT!";if(r.children&&r.children.length>0){for(var n=0;n<r.children.length;n++)t(r.children[n]);a.pop()}else a.pop()};t(n)})()}catch(i){}}return a},fetchData:function(e){this.treeData=[{id:0,label:"【所有类别】",children:e}]},renderContent:function(e,t){var a=t.node,r=t.data,n=(t.store,this);return e("span",{attrs:{style:"flex: 1; display: flex; align-items: center; justify-content: space-between; font-size: 14px; padding-right: 8px;"}},[e("span",[e("span",{attrs:{style:"float: left;"}},a.label)]),e("span",[e("el-button",{attrs:{size:"mini",style:"font-size: 12px;padding: 3px",type:"text",plain:""},on:{click:function(){var e=n.deepCopy(n.treeData);n.formDialogVisible=!0,n.formDialogStatus="create",delete n.form.id,n.form.name="",n.form.parentId=r.id;var t=n.getNodePath(n.form.parentId,e);n.typeList=n.setDisabledNode(e,null),n.currentNodePath=t}}},"添加"),e("el-button",{attrs:{size:"mini",style:"font-size: 12px;padding: 3px;"+(0===r.id?"display:none;":""),type:"text",plain:""},on:{click:function(){if(0!==r.id){var e=n.deepCopy(n.treeData);n.formDialogVisible=!0,n.formDialogStatus="update",n.form.id=r.id,n.form.name=r.label,n.form.parentId=r.parentId;var t=n.getNodePath(n.form.id,e),a=t.pop();n.typeList=n.setDisabledNode(e,a),n.currentNodePath=t}}}},"编辑"),e("el-button",{attrs:{size:"mini",style:"font-size: 12px;color:red;padding: 3px;"+(0===r.id?"display:none;":""),type:"text",plain:""},on:{click:function(){0!==r.id&&n.$confirm('将删除类别 <span style="color:blue">'+r.label+"</span>，若此类别下有知识条目，删除此类别后，只能在【所有类别】中查看这些知识条目，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0}).then(function(){n.listLoading=!0,Object(i["d"])(r.id).then(function(e){n.listLoading=!1,n.refreshNode(),Object(o["b"])(e,"删除")})}).catch(function(){})}}},"删除")])])},postData:function(){var e=this;this.$refs["formData"].validate(function(t){t&&("update"===e.formDialogStatus?(e.listLoading=!0,Object(i["i"])(e.form).then(function(t){e.listLoading=!1,e.formDialogVisible=!1,e.refreshNode(),Object(o["b"])(t,"更新")})):"create"===e.formDialogStatus&&(e.listLoading=!0,Object(i["b"])(e.form).then(function(t){e.listLoading=!1,e.formDialogVisible=!1,e.refreshNode(),Object(o["b"])(t,"添加")})))})},setCurrentParentId:function(){this.currentNodePath.length>0&&(this.form.parentId=this.currentNodePath[this.currentNodePath.length-1])},setDisabledNode:function(e,t){var a=function e(t,a){var r=t.filter(function(e){return e.id!==a});return r.forEach(function(t){return t.children&&(t.children=e(t.children,a))}),r},r=a(e,t);return r},deepCopy:function(e){return JSON.parse(JSON.stringify(e))},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},setEdtingMode:function(e){this.edtingMode=e},handleNodeClick:function(e){this.$emit("setCurrentSelectedId",e.id)},refreshNode:function(){this.$emit("refreshNode")}}},s=l,c=a("2877"),d=Object(c["a"])(s,r,n,!1,null,"1b13c886",null);t["default"]=d.exports},b24b:function(e,t,a){"use strict";a.d(t,"f",function(){return n}),a.d(t,"e",function(){return i}),a.d(t,"h",function(){return o}),a.d(t,"a",function(){return l}),a.d(t,"c",function(){return s}),a.d(t,"g",function(){return c}),a.d(t,"i",function(){return d}),a.d(t,"b",function(){return u}),a.d(t,"d",function(){return f});var r=a("b775");function n(e,t,a,n){return Object(r["a"])({url:"/dangerousChemicals/table",data:{pageNumber:e,pageSize:t,typeId:a,keyWords:n}})}function i(e){return Object(r["a"])({url:"/dangerousChemicals/dangerousChemicals",data:{id:e}})}function o(e){return Object(r["a"])({url:"/dangerousChemicals/update",data:{form:e}})}function l(e){return Object(r["a"])({url:"/dangerousChemicals/create",data:{form:e}})}function s(e){return Object(r["a"])({url:"/dangerousChemicals/delete",data:{id:e}})}function c(e){return Object(r["a"])({url:"/dangerousChemicalsType/typeList",data:{needChildren:e}})}function d(e){return Object(r["a"])({url:"/dangerousChemicalsType/update",data:{form:e}})}function u(e){return Object(r["a"])({url:"/dangerousChemicalsType/create",data:{form:e}})}function f(e){return Object(r["a"])({url:"/dangerousChemicalsType/delete",data:{id:e}})}},e945:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"masker"}},[a("el-cascader",{attrs:{size:"mini",props:e.cascaderProps,placeholder:"未选择","show-all-levels":!1,options:e.treeData,filterable:"",clearable:!1,"change-on-select":"","expand-trigger":"click"},on:{change:e.setCurrentId},model:{value:e.currentNodePath,callback:function(t){e.currentNodePath=t},expression:"currentNodePath"}})],1)},n=[],i={name:"treeSelector",data:function(){return{treeData:[],cascaderProps:{value:"id"},currentNodePath:[]}},methods:{initData:function(e){this.treeData=e},initCurrentPath:function(e){this.currentNodePath=this.getNodePath(e,this.treeData)},getNodePath:function(e,t){var a=[];try{var r=function t(r){if(a.push(r.id),r.id===parseInt(e))throw"GOT IT!";if(r.children&&r.children.length>0){for(var n=0;n<r.children.length;n++)t(r.children[n]);a.pop()}else a.pop()};r({id:0,children:t})}catch(n){}return a},setCurrentId:function(e){e.length>0?(this.currentNodePath=this.getNodePath(e[e.length-1],this.treeData),this.$emit("setCurrentId",e[e.length-1])):this.$emit("setCurrentId",null)}}},o=i,l=a("2877"),s=Object(l["a"])(o,r,n,!1,null,"ebceff4e",null);t["a"]=s.exports},f7f4:function(e,t,a){}}]);